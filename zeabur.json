{
  "services": [
    {
      "name": "backend",
      "type": "node",
      "root": "server",
      "installCommand": "npm ci --include=dev",
      "buildCommand": "npm run build",
      "startCommand": "npm run start",
      "port": 3001,
      "env": {
        "NODE_VERSION": "20",
        "NODE_ENV": "production",
        "NPM_CONFIG_PRODUCTION": "false",
        "TOKEN_KEY": "<REPLACE_WITH_STRONG_RANDOM>",
        "DATA_DIR": "/app/data"
      },
      "volumes": [
        {
          "path": "/app/data",
          "size": "1Gi"
        }
      ],
      "healthCheck": {
        "path": "/health",
        "interval": 30,
        "timeout": 10,
        "retries": 3
      }
    },
    {
      "name": "frontend",
      "type": "static",
      "root": "frontend",
      "installCommand": "npm ci",
      "buildCommand": "npm run build",
      "outputDir": "dist",
      "env": {
        "NODE_VERSION": "20"
      },
      "rewrites": [
        {
          "source": "/api/(.*)",
          "destination": "http://backend:3001/api/$1"
        }
      ]
    }
  ]
}
